

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Documentation for the parcel model &mdash; parcel 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="parcel 0.1 documentation" href="index.html" />
    <link rel="next" title="Other utilities and useful code" href="utilities.html" />
    <link rel="prev" title="Parcel Model documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="utilities.html" title="Other utilities and useful code"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Parcel Model documentation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">parcel 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="documentation-for-the-parcel-model">
<h1>Documentation for the parcel model<a class="headerlink" href="#documentation-for-the-parcel-model" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-parcel">
<span id="parcel-model-driver"></span><h2>Parcel model &#8211; driver<a class="headerlink" href="#module-parcel" title="Permalink to this headline">¶</a></h2>
<p>Cloud Parcel Model based on Nenes et al, 2001; implemented by
Daniel Rothenberg (<a class="reference external" href="mailto:darothen&#37;&#52;&#48;mit&#46;edu">darothen<span>&#64;</span>mit<span>&#46;</span>edu</a>) as part of research undertaken for the
General examination in the Program in Atmospheres, Oceans, and Climate</p>
<span class="target" id="module-parcel"></span><dl class="class">
<dt id="parcel.ParcelModel">
<em class="property">class </em><tt class="descclassname">parcel.</tt><tt class="descname">ParcelModel</tt><big>(</big><em>aerosols</em>, <em>V</em>, <em>T0</em>, <em>S0</em>, <em>P0</em>, <em>console=False</em><big>)</big><a class="headerlink" href="#parcel.ParcelModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Container class to set-up and run the parcel model.</p>
<p>(full description of parcel model)</p>
<dl class="method">
<dt id="parcel.ParcelModel._setup_run">
<tt class="descname">_setup_run</tt><big>(</big><em>P0</em>, <em>T0</em>, <em>S0</em><big>)</big><a class="headerlink" href="#parcel.ParcelModel._setup_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup the initial parcel state for the run, given the initial
temperature (K), pressure (Pa), and supersaturation.</p>
<p>Based on the aerosol population which has been stored in the model, this
method will finish initializing the model. This has three major parts:</p>
<ol class="arabic">
<li><dl class="first docutils">
<dt>Concate the aerosol population information (their dry radii, hygroscopicites,</dt>
<dd><p class="first last">etc) into single arrays which can be placed into the state vector for forward
integration.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Given the initial ambient water vapor concentration (computed from the temperature,</dt>
<dd><p class="first last">pressure, and supersaturation), determine how much water must already be coated
on the aerosol particles in order for their size to be in equilibrium.</p>
</dd>
</dl>
</li>
<li><p class="first">Set-up the state vector with these initial conditions.</p>
</li>
</ol>
<p>Once the state vector has been set-up, it will return that vector as well as the
aerosol information arrays so that they can be used in the model run. The <cite>ParcelModel</cite>
instance itself does not save that information for future runs; this method is invoked
on every single run of the parcel model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>P0</strong> (<em>float</em>) &#8211; Parcel initial pressure (Pa)</li>
<li><strong>T0</strong> (<em>float</em>) &#8211; Parcel initial temperature (K)</li>
<li><strong>S0</strong> (<em>float</em>) &#8211; Parcel initial supersaturation (decimal with respect to 1.0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>A dictionary containinng the following arrays:</p>
<ul class="simple">
<li><strong>r_drys</strong> - an array with all the aerosol dry radii concatenated together</li>
<li><strong>kappas</strong> - an array with all the aerosol hygroscopicities concatenated together</li>
<li><strong>Nis</strong> - an array with all the aerosol number concentrations for each dry radii
concatenated together</li>
<li><strong>y0</strong> - the initial state vector used in the parcel model run</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="parcel.AerosolSpecies">
<em class="property">class </em><tt class="descclassname">parcel.</tt><tt class="descname">AerosolSpecies</tt><big>(</big><em>species</em>, <em>distribution</em>, <em>kappa</em>, <em>bins=None</em><big>)</big><a class="headerlink" href="#parcel.AerosolSpecies" title="Permalink to this definition">¶</a></dt>
<dd><p>Container class for organizing and passing around important details about
aerosol species present in the parcel model.</p>
<p>To allow flexibility with how aerosols are defined in the model, this class is
meant to act as a wrapper to contain metadata about aerosols (their species name, etc),
their chemical composition (particle mass, hygroscopicity, etc), and the particular
size distribution chosen for the initial dry aerosol. Because the latter could be very
diverse - for instance, it might be desired to have a monodisperse aerosol population,
or a bin representation of a canonical size distribution - the core of this class
is designed to take those representations and homogenize them for use in the model.</p>
<p>An <a class="reference internal" href="#parcel.AerosolSpecies" title="parcel.AerosolSpecies"><tt class="xref py py-class docutils literal"><span class="pre">AerosolSpecies</span></tt></a> instance has the following attributes:</p>
<dl class="attribute">
<dt id="parcel.AerosolSpecies.species">
<tt class="descname">species</tt><a class="headerlink" href="#parcel.AerosolSpecies.species" title="Permalink to this definition">¶</a></dt>
<dd><p>A string representing a name for the particular aerosol species. This is purely
metadata and doesn&#8217;t serve any function in the parcel model except for tagging
aerosols, so this can be set to anything.</p>
</dd></dl>

<dl class="attribute">
<dt id="parcel.AerosolSpecies.kappa">
<tt class="descname">kappa</tt><a class="headerlink" href="#parcel.AerosolSpecies.kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>The hygroscopicity parameter <span class="math">\(\kappa\)</span> of the aerosol species used in
<span class="math">\(\kappa\)</span>-Kohler theory. This should be a <cite>float</cite>, and is non-dimensional.</p>
</dd></dl>

<dl class="attribute">
<dt id="parcel.AerosolSpecies.nr">
<tt class="descname">nr</tt><a class="headerlink" href="#parcel.AerosolSpecies.nr" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of bins in the size distribution. Can be 1, for a monodisperse aerosol.</p>
</dd></dl>

<dl class="attribute">
<dt id="parcel.AerosolSpecies.r_drys">
<tt class="descname">r_drys</tt><a class="headerlink" href="#parcel.AerosolSpecies.r_drys" title="Permalink to this definition">¶</a></dt>
<dd><p>A <tt class="xref py py-mod docutils literal"><span class="pre">numpy</span></tt> array instance containing the representative dry radii for each bin
in the aerosol size distribution. Has length equal to <cite>nr</cite>, and units (m).</p>
</dd></dl>

<dl class="attribute">
<dt id="parcel.AerosolSpecies.rs">
<tt class="descname">rs</tt><a class="headerlink" href="#parcel.AerosolSpecies.rs" title="Permalink to this definition">¶</a></dt>
<dd><p>A <tt class="xref py py-mod docutils literal"><span class="pre">numpy</span></tt> array instance containing the edge of each bin in the aerosol size
distribution. Has length equal to <cite>nr + 1</cite> and units (cm).</p>
</dd></dl>

<dl class="attribute">
<dt id="parcel.AerosolSpecies.Nis">
<tt class="descname">Nis</tt><a class="headerlink" href="#parcel.AerosolSpecies.Nis" title="Permalink to this definition">¶</a></dt>
<dd><p>A <tt class="xref py py-mod docutils literal"><span class="pre">numpy</span></tt> array instance of length <cite>nr</cite> with the number concentration in
(m**-3) of each aerosol size bin.</p>
</dd></dl>

<p>To construct an <a class="reference internal" href="#parcel.AerosolSpecies" title="parcel.AerosolSpecies"><tt class="xref py py-class docutils literal"><span class="pre">AerosolSpecies</span></tt></a>, only the metadata (<cite>species</cite> and <cite>kapa</cite>) and
the size distribution needs to be specified. The size distribution (<cite>distribution</cite>) can be
an instance of <tt class="xref py py-class docutils literal"><span class="pre">parcel_model.lognorm.Lognorm</span></tt>, as long as an extra parameter <cite>bins</cite>,
which is an <cite>int</cite> representing how many bins into which the distribution should be divided,
is also passed to the constructor. In this case, the constructor will figure out how to slice
the size distribution to calculate all the aerosol dry radii and their number concentrations.</p>
<p>Alternatively, a <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt> can be passed as <cite>distribution</cite> where that slicing has
already occurred. In this case, <cite>distribution</cite> must have 2 keys: <em>r_drys</em> and <em>Nis</em>. Each
of the values stored to those keys should fit the attribute descriptors above (although
they don&#8217;t need to be <tt class="xref py py-mod docutils literal"><span class="pre">numpy</span></tt> arrays - they can be any iterable.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example :</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>Constructing sulfate aerosol with a specified lognormal distribution -</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">aerosol1</span> <span class="o">=</span> <span class="n">AerosolSpecies</span><span class="p">(</span><span class="s">&#39;(NH4)2SO4&#39;</span><span class="p">,</span> <span class="n">Lognorm</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mf">300.</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>                          <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
<p>Constructing a monodisperse sodium chloride distribution -</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">aerosol2</span> <span class="o">=</span> <span class="n">AerosolSpecies</span><span class="p">(</span><span class="s">&#39;NaCl&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;r_drys&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="p">],</span> <span class="s">&#39;Nis&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1000.0</span><span class="p">,</span> <span class="p">]},</span> <span class="n">kappa</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Throws a <tt class="xref py py-class docutils literal"><span class="pre">ValueError</span></tt> if an unknown type of <cite>distribution</cite> is passed to the
constructor, or if <cite>bins</cite> isn&#8217;t present when <cite>distribution</cite> is an instance of
<tt class="xref py py-class docutils literal"><span class="pre">parcel_model.lognorm.Lognorm</span></tt></p>
</div>
</dd></dl>

</div>
<div class="section" id="parcel-model-auxilary">
<h2>Parcel model &#8211; auxilary<a class="headerlink" href="#parcel-model-auxilary" title="Permalink to this headline">¶</a></h2>
<p>(another test)</p>
<span class="target" id="module-parcel_aux"></span><span class="target" id="module-parcel"></span><dl class="function">
<dt id="parcel_aux.Seq_gil">
<tt class="descclassname">parcel_aux.</tt><tt class="descname">Seq_gil</tt><big>(</big><big>)</big><a class="headerlink" href="#parcel_aux.Seq_gil" title="Permalink to this definition">¶</a></dt>
<dd><p>Header of <tt class="xref py py-func docutils literal"><span class="pre">parcel_model.micro.Seq()</span></tt> ported to Cython and GIL-released.</p>
</dd></dl>

<dl class="function">
<dt id="parcel_aux.der">
<tt class="descclassname">parcel_aux.</tt><tt class="descname">der</tt><big>(</big><big>)</big><a class="headerlink" href="#parcel_aux.der" title="Permalink to this definition">¶</a></dt>
<dd><p>Time-derivatives of variables tracked by the parcel model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>np.ndarray</em>) &#8211; <dl class="docutils">
<dt>Vector representing the current state of the parcel model system,</dt>
<dd><ul class="first last">
<li>P - pressure (Pa)</li>
<li>T - temperature (K)</li>
<li>wv - water vapor mass mixing ratio (kg/kg)</li>
<li>wc - droplet liquid water mass mixing ratio (kg/kg)</li>
<li>S - parcel supersaturation</li>
<li><dl class="first docutils">
<dt>rs - droplet radii (m)</dt>
<dd>&#8211; the final <em>nr</em> elements of the state vector <cite>y</cite></dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><strong>t</strong> (<em>float</em>) &#8211; Current time-step at which derivatives are being computed</li>
<li><strong>nr</strong> (<em>int</em>) &#8211; Total number of aerosol radii (across all species) being tracked within
the parcel model and in the state vector <cite>y</cite></li>
<li><strong>r_drys</strong> (<em>np.ndarray</em>) &#8211; Dry radii (m) of all the wetted aerosol being tracked, concatenated across all
species into a single array of length <cite>nr</cite>. Should correspond to the order in
which the wetted radii appear in <cite>y</cite></li>
<li><strong>Nis</strong> (<em>np.ndarray</em>) &#8211; Number concentrations (m**-3) of the wetted aerosols being tracked,
concatenated across all species into a single array of length <cite>nr</cite></li>
<li><strong>V</strong> (<em>float</em>) &#8211; Updraft velocity (m)</li>
<li><strong>kappas</strong> (<em>np.ndarray</em>) &#8211; Aerosol hygroscopicities, concatenated across all species into a single
array of length <cite>nr</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">derivatives of all variables in state vector <cite>y</cite>, in their original order</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="parcel_aux.guesses">
<tt class="descclassname">parcel_aux.</tt><tt class="descname">guesses</tt><big>(</big><big>)</big><a class="headerlink" href="#parcel_aux.guesses" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a parcel&#8217;s temperature and supersaturation as well as a size distribution
of aerosols and their kappa parameters, computes seed guesses for determining
the equilibrium wet radii of the inactivated aerosols or, when possible, the exact
equilibrium solution.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Documentation for the parcel model</a><ul>
<li><a class="reference internal" href="#module-parcel">Parcel model &#8211; driver</a></li>
<li><a class="reference internal" href="#parcel-model-auxilary">Parcel model &#8211; auxilary</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Parcel Model documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="utilities.html"
                        title="next chapter">Other utilities and useful code</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/parcel.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="utilities.html" title="Other utilities and useful code"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Parcel Model documentation"
             >previous</a> |</li>
        <li><a href="index.html">parcel 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Daniel Rothenberg.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>